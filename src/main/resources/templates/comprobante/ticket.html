<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title th:text="${comprobante.tipoComprobante} + ' ' + ${comprobante.numeroComprobante}">Comprobante</title>
<style>
:root{--ancho:72mm;}
body{margin:0;padding:0;background:#fff;}
.ticket{
  width:var(--ancho);margin:0 auto;background:#fff;padding:8px 10px;
  border:1px solid #222;font-family:'Segoe UI',Arial,sans-serif;font-size:12px;color:#000;
}
hr{border:none;border-top:1px solid #222;margin:.5rem 0;}
h1,h2,h3,h4,h5{margin:0;font-weight:600;}
.header{text-align:center;}
.header .empresa{font-size:13px;font-weight:700;text-transform:uppercase;}
.header .ruc{font-size:12px;font-weight:600;margin-top:2px;}
.titulo-doc{margin-top:.35rem;font-size:13px;font-weight:700;}
.seccion-tit{font-weight:600;font-size:12px;margin:.4rem 0 .15rem;}
.datos, .totales, .op-table{width:100%;font-size:11px;}
.datos td{padding:0 0 2px 0;vertical-align:top;}
.items{width:100%;border-collapse:collapse;font-size:11px;margin-top:.4rem;}
.items thead td{border-bottom:1px solid #222;font-weight:600;}
.items td{padding:2px 0;vertical-align:top;}
.items tbody tr:not(:last-child) td{border-bottom:1px dashed #999;}
.text-right{text-align:right;}
.text-center{text-align:center;}
.bold{font-weight:600;}
.small{font-size:10px;}
.qr{margin-top:.6rem;text-align:center;}
.totales td{padding:2px 0;}
.op-table td{padding:1px 0;}
.monto-letras{margin:.5rem 0;font-size:11px;font-style:italic;}
.footer{text-align:center;margin-top:.6rem;font-size:10px;}
.no-print{margin:.5rem 0;text-align:center;}
.no-print button, .no-print a{font-size:11px;padding:4px 8px;border:1px solid #444;background:#eee;border-radius:4px;text-decoration:none;color:#000;cursor:pointer;}
@media print{.no-print{display:none!important;} body{background:#fff;}}
</style>
</head>
<body>
<div class="ticket">
    <div class="no-print">
        <button onclick="window.print()">Imprimir / PDF</button>
        <a th:href="@{/comprobantes/detalle/{id}(id=${comprobante.idComprobante})}">Vista completa</a>
    </div>
    <div class="header">
        <div class="empresa">IPHONESTORE S.A.C.</div>
        <div class="ruc">RUC: 20089762534</div>
        <div class="titulo-doc" th:text="${comprobante.tipoComprobante} + ' ELECTRÓNICA'">BOLETA ELECTRÓNICA</div>
        <div class="titulo-doc" th:text="${comprobante.numeroComprobante}">BOL000001</div>
        <hr>
    </div>

    <div class="seccion-tit">CLIENTE</div>
    <table class="datos">
        <tr>
            <td style="width:22%">Señor(es):</td>
            <td th:text="${comprobante.cliente?.nombre}">Cliente Ejemplo</td>
        </tr>
        <tr>
            <td>Doc:</td>
            <td th:text="${comprobante.cliente?.documento}">12345678</td>
        </tr>
        <tr>
            <td>Fecha:</td>
            <td th:text="${#temporals.format(comprobante.fechaEmision,'dd/MM/yyyy HH:mm')}">11/08/2025 23:45</td>
        </tr>
        <tr>
            <td>Pago:</td>
            <td th:text="${comprobante.tipoPago}">Transferencia</td>
        </tr>
        <tr>
            <td>Pedido:</td>
            <td th:text="'P-' + ${comprobante.pedido.idPedido}">P-10</td>
        </tr>
    </table>
    <hr>

    <table class="items">
        <thead>
            <tr>
                <td style="width:42%">Producto</td>
                <td style="width:12%" class="text-center">Cant.</td>
                <td style="width:21%" class="text-right">P.Unit</td>
                <td style="width:25%" class="text-right">Importe</td>
            </tr>
        </thead>
        <tbody>
            <tr th:each="d : ${detalles}">
                <td>
                    <span th:text="${d.producto?.modelo}">iPhone</span>
                    <div class="small" th:text="${d.producto?.almacenamiento}">128 GB</div>
                </td>
                <td class="text-center" th:text="${d.cantidad}">1</td>
                <td class="text-right" th:text="${#numbers.formatDecimal(d.precioUnitario,1,2)}">3799.00</td>
                <td class="text-right" th:text="${#numbers.formatDecimal(d.precioUnitario * d.cantidad,1,2)}">3799.00</td>
            </tr>
        </tbody>
    </table>

    <hr>
    <table class="op-table">
        <tr>
            <td>OP. GRAVADAS</td>
            <td class="text-right" th:text="${#numbers.formatDecimal(comprobante.subtotal,1,2)}">0.00</td>
        </tr>
        <tr>
            <td>OP. GRATUITAS</td>
            <td class="text-right">0.00</td>
        </tr>
        <tr>
            <td>OP. EXONERADAS</td>
            <td class="text-right">0.00</td>
        </tr>
        <tr>
            <td>OP. INAFECTAS</td>
            <td class="text-right">0.00</td>
        </tr>
        <tr>
            <td>I.G.V (18%)</td>
            <td class="text-right" th:text="${#numbers.formatDecimal(comprobante.igv,1,2)}">0.00</td>
        </tr>
        <tr>
            <td class="bold">SUB TOTAL</td>
            <td class="text-right" th:text="${#numbers.formatDecimal(comprobante.subtotal,1,2)}">0.00</td>
        </tr>
        <tr>
            <td class="bold">TOTAL VENTA</td>
            <td class="text-right bold" th:text="${#numbers.formatDecimal(comprobante.totalPagar,1,2)}">0.00</td>
        </tr>
    </table>

    <div class="monto-letras" th:text="${montoEnLetras}">TRES MIL SETECIENTOS NOVENTA Y NUEVE CON 00/100 SOLES</div>

    <div class="seccion-tit">VENDEDOR</div>
    <div class="small" th:text="${comprobante.usuario?.nombres}">Nombre Usuario</div>

    <hr>
    <div class="qr">
        <img th:src="@{/comprobantes/qrcode/{id}(id=${comprobante.idComprobante})}" alt="QR" style="width:120px;height:120px">
    </div>
    <div class="footer">
        Representación impresa de la <span th:text="${comprobante.tipoComprobante}">BOLETA</span> electrónica<br>
        Gracias por su preferencia
    </div>
</div>
</body>
</html>