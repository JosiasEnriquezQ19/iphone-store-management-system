# ===============================================
# CONFIGURACION SPRING BOOT - iPhone Store App
# ===============================================

# Configuración de la aplicación
spring.application.name=iPhone Store Management System
server.port=8091
server.servlet.context-path=/iphone-store

# ===============================================
# CONFIGURACION DE BASE DE DATOS MYSQL - RAILWAY
# ===============================================
spring.datasource.url=jdbc:mysql://shinkansen.proxy.rlwy.net:18598/railway?useSSL=true&serverTimezone=UTC&allowPublicKeyRetrieval=true&characterEncoding=UTF8
spring.datasource.username=root
spring.datasource.password=RPBPxQJOaCvkgwBjmZulhkjQLaBkWjiJ
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Pool de conexiones HikariCP (optimizado)
spring.datasource.hikari.maximum-pool-size=15
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# ===============================================
# CONFIGURACION HIBERNATE/JPA
# ===============================================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=America/Lima
spring.jpa.properties.hibernate.connection.characterEncoding=utf8
spring.jpa.properties.hibernate.connection.CharSet=utf8
spring.jpa.properties.hibernate.connection.useUnicode=true

# Configuración de transacciones
spring.jpa.properties.hibernate.current_session_context_class=thread
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ===============================================
# CONFIGURACION THYMELEAF
# ===============================================
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.servlet.content-type=text/html;charset=UTF-8

# ===============================================
# CONFIGURACION DEVTOOLS (Solo desarrollo)
# ===============================================
spring.devtools.restart.enabled=true
spring.devtools.restart.poll-interval=1s
spring.devtools.restart.quiet-period=400ms
spring.devtools.livereload.enabled=true

# ===============================================
# CONFIGURACION SPRING SECURITY
# ===============================================
# Usuario administrador por defecto (solo desarrollo)
spring.security.user.name=admin
spring.security.user.password=admin123
spring.security.user.roles=ADMIN

# Configuración de sesiones
server.servlet.session.timeout=30m
server.servlet.session.cookie.name=JSESSIONID_IPHONE_STORE
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=lax

# ===============================================
# CONFIGURACION DE LOGGING
# ===============================================
# Configuración general de logging
logging.level.root=INFO
logging.level.com.idat.continua2.demo=DEBUG
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.springframework.mail=DEBUG

# Configuración de archivos de log
logging.file.name=logs/iphone-store.log
logging.logback.rollingpolicy.file-name-pattern=logs/iphone-store-%d{yyyy-MM-dd}.%i.log
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=30
logging.logback.rollingpolicy.total-size-cap=300MB

# ===============================================
# CONFIGURACION DE INTERNACIONALIZACION
# ===============================================
spring.messages.basename=messages
spring.messages.encoding=UTF-8
spring.web.locale=es_PE
spring.web.locale-resolver=fixed

# ===============================================
# CONFIGURACION DE RECURSOS ESTATICOS
# ===============================================
spring.web.resources.static-locations=classpath:/static/
spring.web.resources.cache.period=3600
spring.mvc.static-path-pattern=/static/**

# ===============================================
# CONFIGURACION DE FORMATO DE FECHAS
# ===============================================
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=America/Lima
spring.mvc.format.date=yyyy-MM-dd
spring.mvc.format.date-time=yyyy-MM-dd HH:mm:ss
spring.mvc.format.time=HH:mm:ss

# ===============================================
# CONFIGURACION EMAIL - CORREGIDA
# ===============================================
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=albertocarrillomillones20@gmail.com
spring.mail.password=hlxk vmjm uujk oque
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# ===============================================
# CONFIGURACION ADICIONAL DE LA APLICACION
# ===============================================
# Configuración de uploads (si se necesita)
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Configuración de compresión
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# ===============================================
# CONFIGURACION DE DESARROLLO (Solo para DEV)
# ===============================================
# Activar perfiles específicos si es necesario
spring.profiles.active=dev

# Debug adicional para desarrollo
spring.jpa.properties.hibernate.show_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.generate_statistics=false

# ===============================================
# CONFIGURACION DE ACTUATOR (Monitoreo)
# ===============================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.info.env.enabled=true

# ===============================================
# CONFIGURACION DE ENCODING
# ===============================================
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true